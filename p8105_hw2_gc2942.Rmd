---
title: "HW2"
output: github_document
---

##Problem 1
```{r setup}
library(tidyverse)
library(dplyr)
```


```{r}
Trash_data = 
  readxl::read_excel(
    "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
    sheet = "Mr. Trash Wheel",
    range = "A2:N533" ,
    na  = "")  %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(sports_balls = round(sports_balls))
```

```{r}
precipitation_2019_data = 
    readxl::read_excel(
    "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
    sheet = "2019 Precipitation",
    range = "A2:B14") %>%
    mutate(year = "2019")

precipitation_2018_data =
     readxl::read_excel(
    "./data/Trash-Wheel-Collection-Totals-7-2020-2.xlsx",
    sheet = "2018 Precipitation",
    range = "A2:B14") %>%
    mutate(year = "2018")
precipitation_df =  bind_rows(precipitation_2019_data,precipitation_2018_data) %>%
  janitor::clean_names() %>%
  mutate(month = month.name[month])

```
 
In Mr. Trash Wheel data set, it has `r nrow(Trash_data)` and contains `r names(Trash_data)` variables. In the combination of precipitation, it has `r nrow(precipitation_df)` and there are `r names(precipitation_df)` in the precipitation. 
The total precipitation in 2018 `r sum(pull(filter(precipitation_df,year == 2018),total))`.
The median number of sports balls in a dumpster in 2019 is`r median(pull(filter(Trash_data, year == 2019),sports_balls))`.


##Problem 2

##Problem 3


```{r}
Baby_df = 
   read_csv("./data/Popular_Baby_Names.csv") %>%
   janitor::clean_names() %>%   
   mutate(ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER","WHITE NON HISP" = "WHITE NON HISPANIC", "BLACK NON HISP" = "BLACK NON HISPANIC")) %>%
   mutate(childs_first_name = toupper(childs_first_name)) %>%
   distinct(childs_first_name,year_of_birth,gender,ethnicity,.keep_all = TRUE) %>%
   filter(childs_first_name == "OLIVIA", gender == "FEMALE") 
Baby_df %>%
  janitor::clean_names() %>%
  arrange(year_of_birth) %>%
  pivot_wider(
    names_from = "year_of_birth",
    values_from = "rank"
  ) %>%
  select(-count) %>%
  relocate(childs_first_name,gender,ethnicity)
```
In this problem, I use `r unique(pull(Baby_df,childs_first_name))` and `r unique(pull(Baby_df,ethnicity))` to check the change of string variable over time.
```{r}
Baby_male_df = 
  read_csv("./data/Popular_Baby_Names.csv") %>%
   janitor::clean_names() %>%   
   mutate(ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER","WHITE NON HISP" = "WHITE NON HISPANIC", "BLACK NON HISP" = "BLACK NON HISPANIC")) %>%
   mutate(childs_first_name = toupper(childs_first_name)) %>%
   distinct(childs_first_name,year_of_birth,gender,ethnicity,.keep_all = TRUE) %>%
   filter(gender == "MALE",rank == 1) %>%
   pivot_wider(
    names_from = "year_of_birth",
    values_from = "rank"
    ) %>%
   janitor::clean_names() %>%
   relocate(gender,childs_first_name)
```

```{r}
children_2016 = 
   read_csv("./data/Popular_Baby_Names.csv") %>%
   janitor::clean_names() %>% 
   mutate(ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER","WHITE NON HISP" = "WHITE NON HISPANIC", "BLACK NON HISP" = "BLACK NON HISPANIC")) %>%
   distinct(childs_first_name,year_of_birth,gender,ethnicity,.keep_all = TRUE) %>%
   filter(gender == "MALE",ethnicity == "WHITE NON HISPANIC", year_of_birth == 2016) %>%
   ggplot(aes(rank, count)) + geom_point()

```









 


